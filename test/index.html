<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Mocha Spec Runner</title>
    <link rel="stylesheet" href="bower_components/mocha/mocha.css">
</head>
<body>
    <div id="mocha"></div>
    <div id="ember-fixture"></div>

    <!-- include source files here... -->
    <!-- build:js /scripts/vendor.js -->
    <!-- bower:js -->
    <script src="/bower_components/jquery/dist/jquery.js"></script>
    <script src="/bower_components/handlebars/handlebars.js"></script>
    <script src="/bower_components/ember/ember.js"></script>
    <script src="/bower_components/picturefill/dist/picturefill.js"></script>
    <script src="/bower_components/dropzone/downloads/dropzone.min.js"></script>
    <script src="/bower_components/ember-model/ember-model.js"></script>
    <script src="/bower_components/cldr/plurals.js"></script>
    <script src="/bower_components/ember-i18n/lib/i18n.js"></script>
    <!-- endbower -->
    <!-- endbuild -->

    <!-- build:js({app,.tmp}) /scripts/main.js -->
    <script src="/scripts/utils/utils.js"></script>
    <script src="/scripts/utils/infiniteScroll.js"></script>
    <script src="/scripts/utils/facebook.js"></script>
    <script src="/scripts/main.js"></script>
    <script src="/scripts/adapters/apiAdapter.js"></script>
    <script src="/scripts/routes/signedInRouteMixin.js"></script>
    <script src="/scripts/routes/photosAddToAlbumRoute.js"></script>
    <script src="/scripts/routes/albumPhotosRoute.js"></script>
    <script src="/scripts/routes/albumRoute.js"></script>
    <script src="/scripts/routes/albumsRoute.js"></script>
    <script src="/scripts/routes/photosRoute.js"></script>
    <script src="/scripts/routes/signinRoute.js"></script>
    <script src="/scripts/routes/registrationRoute.js"></script>
    <script src="/scripts/routes/uploadRoute.js"></script>
    <script src="/scripts/controllers/fbControllerMixin.js"></script>
    <script src="/scripts/controllers/photosAddToAlbumController.js"></script>
    <script src="/scripts/controllers/basePhotoController.js"></script>
    <script src="/scripts/controllers/basePhotosController.js"></script>
    <script src="/scripts/controllers/albumsController.js"></script>
    <script src="/scripts/controllers/albumPhotoController.js"></script>
    <script src="/scripts/controllers/albumPhotosController.js"></script>
    <script src="/scripts/controllers/applicationController.js"></script>
    <script src="/scripts/controllers/photoController.js"></script>
    <script src="/scripts/controllers/photosController.js"></script>
    <script src="/scripts/controllers/registrationController.js"></script>
    <script src="/scripts/controllers/signinController.js"></script>
    <script src="/scripts/views/albumsView.js"></script>
    <script src="/scripts/views/albumPhotosView.js"></script>
    <script src="/scripts/views/imageView.js"></script>
    <script src="/scripts/views/photoView.js"></script>
    <script src="/scripts/views/albumPhotoView.js"></script>
    <script src="/scripts/views/photosView.js"></script>
    <script src="/scripts/views/photosAddToAlbumView.js"></script>
    <script src="/scripts/views/registrationView.js"></script>
    <script src="/scripts/views/signinView.js"></script>
    <script src="/scripts/views/uploadView.js"></script>
    <script src="/scripts/models/modelProxy.js"></script>
    <script src="/scripts/models/album.js"></script>
    <script src="/scripts/models/identity.js"></script>
    <script src="/scripts/models/photo.js"></script>
    <script src="/scripts/models/registration.js"></script>
    <script src="/scripts/models/session.js"></script>
    <script src="/scripts/upload/uploadSignature.js"></script>
    <script src="/scripts/upload/uploadToS3.js"></script>
    <script src="/scripts/i18n/translations.js"></script>
    <script src="/templates.js"></script>
    <!-- endbuild -->

    <script src="bower_components/mocha/mocha.js"></script>
    <script src="bower_components/chai/chai.js"></script>
    <script src="bower_components/ember-mocha-adapter/adapter.js"></script>
    <script src="bower_components/jquery-mockjax/jquery.mockjax.js"></script>
    <script>
      var assert = chai.assert;
      var expect = chai.expect;
      var should = chai.should();

      Ember.testing = true;

      App.rootElement = '#ember-fixture';
      App.setupForTesting();
      App.injectTestHelpers();

      function stubEndpointForHttpRequest(url, json) {
        $.mockjax({
          url: url,
          dataType: 'json',
          responseText: json
        });
      }

      $.mockjaxSettings.logging = false;
      $.mockjaxSettings.responseTime = 0;

      getCurrentRoute = function () {
        var router = App.__container__.lookup("router:main"); //get the main router
        var currentHandlerInfos = router.router.currentHandlerInfos; //get all handlers
        var activeHandler = currentHandlerInfos[currentHandlerInfos.length - 1]; // get active handler
        var activeRoute = activeHandler.handler; // active route

        return activeRoute;
      }
    </script>

    <!-- include spec files here... -->
    <script src="spec/test.js"></script>

    <script>
      Ember.$(function() {
        mocha.run();
      });
    </script>
</body>
</html>
